services:


  dremio:
    image: dremio/dremio-oss
    user: root
    ports:
      - "9047:9047"
      - "31010:31010"
      - "32010:32010"
      - "45678:45678"
    volumes:
      - ./volumes-gitexclude/dremio/data:/opt/dremio/data
      - ./volumes-gitexclude/dremio/logs:/opt/dremio/logs
      - ./data/csv:/csv
      - ./jdbc:/jdbc
    networks:
      - dbtest_network
    entrypoint: |
      /bin/bash -c "
      echo 'Copying driver'
      cp -n /opt/dremio/jars/jdbc-driver/*.jar /jdbc/driver-gitexclude.jar
      echo 'Starting dremio'
      cd /opt/dremio
      bin/dremio start-fg 
      " 

  
  ontop:
    image: ontop/ontop
    environment:
      #ONTOP_ONTOLOGY_FILE: /opt/ontop/input/1/mapping.ttl
      ONTOP_MAPPING_FILE: /opt/ontop/input/ontop-website-mapping.ttl
      ONTOP_PROPERTIES_FILE: /opt/ontop/input/ontop.properties
      ONTOP_CORS_ALLOWED_ORIGINS: "*"
      ONTOP_DEV_MODE: "true"
      ONTOP_LAZY_INIT: "true"
    volumes:
      - ./data/ontology:/opt/ontop/input
      - ./jdbc:/opt/ontop/jdbc
    ports:
      - "8180:8080"
    networks:
      - dbtest_network


    #command: tail -F anything





  postgres1:
    image: postgres:16.4-alpine3.20
    environment:
      # Example auth - just for testing purposes
      POSTGRES_USER: user
      POSTGRES_PASSWORD: pass
      POSTGRES_DB: example
    volumes:
      - ./volumes-gitexclude/postgres1:/var/lib/postgresql/data
    ports:
      - "5531:5432"
    networks:
      - dbtest_network



  postgres2:
    image: postgres:16.4-alpine3.20
    environment:
      POSTGRES_USER: user
      POSTGRES_PASSWORD: pass
      POSTGRES_DB: example
    volumes:
      - ./volumes-gitexclude/postgres2:/var/lib/postgresql/data
    ports:
      - "5532:5432"
    networks:
      - dbtest_network


  postgres3:
    image: postgres:16.4-alpine3.20
    environment:
      POSTGRES_USER: user
      POSTGRES_PASSWORD: pass
      POSTGRES_DB: example
    volumes:
      - ./volumes-gitexclude/postgres3:/var/lib/postgresql/data
    ports:
      - "5533:5432"
    networks:
      - dbtest_network


networks:
  dbtest_network:
    driver: bridge